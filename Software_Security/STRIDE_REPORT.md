# Threat Modeling â€“ STRIDE con Mitigazioni

La seguente tabella include l'analisi delle minacce secondo STRIDE con le relative contromisure adottate o pianificate.

| Unnamed: 0 | Elemento | Threat Type                                                                         | Descrizione                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                | Impatto | Likelihood | Risk Score | Stato     | Mitigazione Applicata                                      |
| ---------- | -------- | ----------------------------------------------------------------------------------- | ---------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------------- | ------- | ---------- | ---------- | --------- | ---------------------------------------------------------- |
| 0          | HTTP     | Spoofing of Destination Data Store app-db                                           | app-db may be spoofed by an attacker and this may lead to data being written to the attacker's target instead of app-db. Consider using a standard authentication mechanism to identify the destination data store.                                                                                                                                                                                                                                                                                        | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 1          | HTTP     | Potential SQL Injection Vulnerability for app-db                                    | SQL injection is an attack in which malicious code is inserted into strings that are later passed to an instance of SQL Server for parsing and execution. Any procedure that constructs SQL statements should be reviewed for injection vulnerabilities because SQL Server will execute all syntactically valid queries that it receives. Even parameterized data can be manipulated by a skilled and determined attacker.                                                                                 | Alto    | Medio      | 4          | Mitigated | Uso di ORM Prisma che parametrizza le query                |
| 2          | HTTP     | Potential Excessive Resource Consumption for express nodejs or app-db               | Does express nodejs or app-db take explicit steps to control resource consumption? Resource consumption attacks can be hard to deal with, and there are times that it makes sense to let the OS do the job. Be careful that your resource requests don't deadlock, and that they do timeout.                                                                                                                                                                                                               | Alto    | Medio      | 4          | Mitigated | Rate limiting e monitoraggio accessi nel cluster interno   |
| 3          | HTTP     | Potential Excessive Resource Consumption for keycloak or app-db                     | Does keycloak or app-db take explicit steps to control resource consumption? Resource consumption attacks can be hard to deal with, and there are times that it makes sense to let the OS do the job. Be careful that your resource requests don't deadlock, and that they do timeout.                                                                                                                                                                                                                     | Alto    | Medio      | 4          | Mitigated | Rate limiting e monitoraggio accessi nel cluster interno   |
| 4          | HTTP     | Potential SQL Injection Vulnerability for app-db                                    | SQL injection is an attack in which malicious code is inserted into strings that are later passed to an instance of SQL Server for parsing and execution. Any procedure that constructs SQL statements should be reviewed for injection vulnerabilities because SQL Server will execute all syntactically valid queries that it receives. Even parameterized data can be manipulated by a skilled and determined attacker.                                                                                 | Alto    | Medio      | 4          | Mitigated | Uso di ORM Prisma che parametrizza le query                |
| 5          | HTTP     | Potential Excessive Resource Consumption for keycloak or keycloak-db                | Does keycloak or keycloak-db take explicit steps to control resource consumption? Resource consumption attacks can be hard to deal with, and there are times that it makes sense to let the OS do the job. Be careful that your resource requests don't deadlock, and that they do timeout.                                                                                                                                                                                                                | Alto    | Medio      | 4          | Mitigated | Rate limiting e monitoraggio accessi nel cluster interno   |
| 6          | HTTP     | Potential SQL Injection Vulnerability for keycloak-db                               | SQL injection is an attack in which malicious code is inserted into strings that are later passed to an instance of SQL Server for parsing and execution. Any procedure that constructs SQL statements should be reviewed for injection vulnerabilities because SQL Server will execute all syntactically valid queries that it receives. Even parameterized data can be manipulated by a skilled and determined attacker.                                                                                 | Alto    | Medio      | 4          | Mitigated | DB Gestito interamente da Keycloak                         |
| 7          | HTTP     | Spoofing of Destination Data Store keycloak-db                                      | keycloak-db may be spoofed by an attacker and this may lead to data being written to the attacker's target instead of keycloak-db. Consider using a standard authentication mechanism to identify the destination data store.                                                                                                                                                                                                                                                                              | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 8          | HTTP     | Elevation Using Impersonation                                                       | keycloak may be able to impersonate the context of express nodejs in order to gain additional privilege.                                                                                                                                                                                                                                                                                                                                                                                                   | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 9          | HTTP     | express nodejs Process Memory Tampered                                              | If express nodejs is given access to memory, such as shared memory or pointers, or is given the ability to control what keycloak executes (for example, passing back a function pointer.), then express nodejs can tamper with keycloak. Consider if the function could work with less access to memory, such as passing data rather than pointers. Copy in data provided, and then validate it.                                                                                                           | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 10         | HTTP     | Potential Data Repudiation by express nodejs                                        | express nodejs claims that it did not receive data from a source outside the trust boundary. Consider using logging or auditing to record the source, time, and summary of the received data.                                                                                                                                                                                                                                                                                                              | Alto    | Medio      | 4          | Mitigated | Audit log e autenticazione utente tracciabile              |
| 11         | HTTPS    | nginx ingress May be Subject to Elevation of Privilege Using Remote Code Execution  | Human User may be able to remotely execute code for nginx ingress.                                                                                                                                                                                                                                                                                                                                                                                                                                         | Alto    | Medio      | 4          | Mitigated | Principio del least privilege, container isolati           |
| 12         | HTTP     | Cross Site Scripting                                                                | The web server 'express nodejs' could be a subject to a cross-site scripting attack because it does not sanitize untrusted input.                                                                                                                                                                                                                                                                                                                                                                          | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 13         | HTTP     | Potential Lack of Input Validation for express nodejs                               | Data flowing across HTTP may be tampered with by an attacker. This may lead to a denial of service attack against express nodejs or an elevation of privilege attack against express nodejs or an information disclosure by express nodejs. Failure to verify that input is as expected is a root cause of a very large number of exploitable issues. Consider all paths and the way they handle data. Verify that all input is verified for correctness using an approved list input validation approach. | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 14         | HTTP     | Spoofing the express nodejs Process                                                 | express nodejs may be spoofed by an attacker and this may lead to information disclosure by nginx ingress. Consider using a standard authentication mechanism to identify the destination process.                                                                                                                                                                                                                                                                                                         | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 15         | HTTP     | Spoofing the nginx ingress Process                                                  | nginx ingress may be spoofed by an attacker and this may lead to unauthorized access to express nodejs. Consider using a standard authentication mechanism to identify the source process.                                                                                                                                                                                                                                                                                                                 | Alto    | Medio      | 4          | Mitigated | HTTPS + Cert Manager con TLS certificate                   |
| 16         | HTTPS    | Elevation by Changing the Execution Flow in nginx ingress                           | An attacker may pass data into nginx ingress in order to change the flow of program execution within nginx ingress to the attacker's choosing.                                                                                                                                                                                                                                                                                                                                                             | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 17         | HTTPS    | Elevation Using Impersonation                                                       | nginx ingress may be able to impersonate the context of Human User in order to gain additional privilege.                                                                                                                                                                                                                                                                                                                                                                                                  | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 18         | HTTPS    | Data Flow HTTPS Is Potentially Interrupted                                          | An external agent interrupts data flowing across a trust boundary in either direction.                                                                                                                                                                                                                                                                                                                                                                                                                     | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 19         | HTTPS    | Potential Process Crash or Stop for nginx ingress                                   | nginx ingress crashes, halts, stops or runs slowly; in all cases violating an availability metric.                                                                                                                                                                                                                                                                                                                                                                                                         | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 20         | HTTPS    | Potential Data Repudiation by nginx ingress                                         | nginx ingress claims that it did not receive data from a source outside the trust boundary. Consider using logging or auditing to record the source, time, and summary of the received data.                                                                                                                                                                                                                                                                                                               | Alto    | Medio      | 4          | Mitigated | Audit log e autenticazione utente tracciabile              |
| 21         | HTTPS    | JavaScript Object Notation Processing                                               | If a dataflow contains JSON, JSON processing and hijacking threats may be exploited.                                                                                                                                                                                                                                                                                                                                                                                                                       | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 22         | HTTPS    | Spoofing the Human User External Entity                                             | Human User may be spoofed by an attacker and this may lead to unauthorized access to nginx ingress. Consider using a standard authentication mechanism to identify the external entity.                                                                                                                                                                                                                                                                                                                    | Alto    | Medio      | 4          | Mitigated | HTTPS + Cert Manager con TLS certificate                   |
| 23         | HTTP     | Data Flow Sniffing                                                                  | Data flowing across HTTP may be sniffed by an attacker. Depending on what type of data an attacker can read, it may be used to attack other parts of the system or simply be a disclosure of information leading to compliance violations. Consider encrypting the data flow.                                                                                                                                                                                                                              | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 24         | HTTP     | Potential Process Crash or Stop for express nodejs                                  | express nodejs crashes, halts, stops or runs slowly; in all cases violating an availability metric.                                                                                                                                                                                                                                                                                                                                                                                                        | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 25         | HTTP     | Data Flow HTTP Is Potentially Interrupted                                           | An external agent interrupts data flowing across a trust boundary in either direction.                                                                                                                                                                                                                                                                                                                                                                                                                     | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 26         | HTTP     | Elevation Using Impersonation                                                       | express nodejs may be able to impersonate the context of nginx ingress in order to gain additional privilege.                                                                                                                                                                                                                                                                                                                                                                                              | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
| 27         | HTTP     | express nodejs May be Subject to Elevation of Privilege Using Remote Code Execution | nginx ingress may be able to remotely execute code for express nodejs.                                                                                                                                                                                                                                                                                                                                                                                                                                     | Alto    | Medio      | 4          | Mitigated | Principio del least privilege, container isolati           |
| 28         | HTTP     | Elevation by Changing the Execution Flow in express nodejs                          | An attacker may pass data into express nodejs in order to change the flow of program execution within express nodejs to the attacker's choosing.                                                                                                                                                                                                                                                                                                                                                           | Alto    | Medio      | 4          | Mitigated | Mitigazione generica tramite rete privata e access control |
